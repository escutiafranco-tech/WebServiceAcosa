<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Catálogo de Proveedores - ACOSA</title>
  <link rel="stylesheet" href="/style.css">
  <link rel="stylesheet" href="/modules.css">
</head>
<body>
  <div class="module-container">
    <!-- Barra de herramientas -->
    <div class="toolbar-module">
      <button id="btnNuevoProveedor" class="toolbar-btn">
        <img src="/Imagenes/Acc_Agregar.png" alt="Nuevo" class="toolbar-icon">
        <span class="toolbar-label">Nuevo</span>
      </button>
      <button id="btnRefrescarProveedores" class="toolbar-btn">
        <img src="/Imagenes/Acc_Actualizar.png" alt="Refrescar" class="toolbar-icon">
        <span class="toolbar-label">Refrescar</span>
      </button>
      <div class="toolbar-divider"></div>
      <div class="toolbar-search">
        <input type="text" id="buscarProveedor" placeholder="Buscar por código, nombre o RFC...">
        <button id="btnBuscarProveedor" class="search-btn">
          <img src="/Imagenes/Acc_Filtrar.png" alt="Buscar" style="width:16px;height:16px;">
        </button>
      </div>
    </div>

    <!-- Listado principal -->
    <div class="list-container">
      <div class="list-body" id="listaProveedores"></div>
    </div>

    <!-- Barra inferior -->
    <div class="barra-inferior-unificada">
      <div class="estadisticas-inferiores">
        <div class="stat-item-inferior">
          <span class="stat-label-inferior">Activos:</span>
          <span class="stat-numero-inferior" id="proveedoresActivos">0</span>
        </div>
        <div class="stat-item-inferior">
          <span class="stat-label-inferior">Inactivos:</span>
          <span class="stat-numero-inferior" id="proveedoresInactivos">0</span>
        </div>
      </div>
      <div class="contador-registros">
        <span id="mostrandoProveedores">Mostrando 0 de 0</span>
      </div>
      <div class="paginacion-inferior">
        <button id="btnAnteriorProveedores" class="btn btn-outline" disabled>← Anterior</button>
        <span id="infoPaginaProveedores">Página 1 de 1</span>
        <button id="btnSiguienteProveedores" class="btn btn-outline" disabled>Siguiente →</button>
      </div>
    </div>

    <!-- Overlay de carga -->
    <div class="loading-overlay" id="loadingProveedores" style="display:none;">
      <div class="loading-spinner"></div>
      <p>Cargando proveedores...</p>
    </div>
  </div>

  <!-- Modal para alta/edición de proveedor -->
  <div id="modalProveedor" class="modal-overlay" style="display:none;">
    <div class="modal-container modal-compact">
      <div class="modal-header">
        <div class="modal-title">
          <h2 id="tituloModalProveedor">Nuevo proveedor</h2>
        </div>
        <div class="modal-header-buttons">
          <button id="btnCerrarModalProveedor" class="btn-header-icon" title="Cerrar">×</button>
        </div>
      </div>

      <!-- Pestañas superiores del modal -->
      <div class="modal-tabs">
        <button type="button" class="tab-button active" data-tab="tab-datos-generales">Datos generales</button>
        <button type="button" class="tab-button" data-tab="tab-expediente">Expediente</button>
        <button type="button" class="tab-button" data-tab="tab-ventas">Ventas y saldos</button>
      </div>

      <div class="modal-content-compact">
        <form id="formProveedor" class="form-container" onsubmit="return false;">
          <input type="hidden" id="provId">

          <!-- TAB: DATOS GENERALES -->
          <div id="tab-datos-generales" class="tab-content active">
            <div class="collapsible-section">
              <div class="section-header-collapse">
                <span class="collapse-icon">▼</span>
                <span class="section-title-text">Información general</span>
              </div>
              <div class="section-body">
                <table class="tabla-formulario-general" style="width:100%; border-collapse:collapse;">
                  <!-- Línea 1: Id, Fecha Registro, Estatus -->
                  <tr>
                    <td style="width:25%;"><strong>Id. Proveedor</strong></td>
                    <td style="width:25%;"><input type="text" id="provIdVisible" class="form-control" readonly></td>
                    <td style="width:25%;"><strong>Fecha registro</strong></td>
                    <td style="width:25%;">
                      <input type="text" id="provFechaRegistro" class="form-control" readonly>
                    </td>
                  </tr>
                  <tr>
                    <td colspan="2"></td>
                    <td style="width:25%;"><strong>Estatus</strong></td>
                    <td style="width:25%;">
                      <label style="display:flex;align-items:center;gap:4px;">
                        <input type="checkbox" id="provActivo" checked>
                        <span>Activo</span>
                      </label>
                    </td>
                  </tr>
                  
                  <!-- Línea 2: Código Proveedor y RFC -->
                  <tr>
                    <td style="width:25%;"><strong>Código Proveedor</strong></td>
                    <td style="width:25%;"><input type="text" id="provCodigo" class="form-control"></td>
                    <td style="width:25%;"><strong>RFC</strong></td>
                    <td style="width:25%;"><input type="text" id="provRFC" class="form-control"></td>
                  </tr>
                  
                  <!-- Línea 3: Nombre (completo) -->
                  <tr>
                    <td style="width:25%;"><strong>Nombre *</strong></td>
                    <td colspan="3"><input type="text" id="provNombre" class="form-control" required></td>
                  </tr>
                  
                  <!-- Línea 4: Dirección -->
                  <tr>
                    <td style="width:25%;"><strong>Dirección</strong></td>
                    <td colspan="3"><input type="text" id="provDireccion" class="form-control"></td>
                  </tr>
                </table>
              </div>
            </div>

            <!-- Secciones de servicios, sucursales y agenda dentro de Datos generales -->
            <div class="collapsible-section">
              <div class="section-header-collapse collapsed">
                <span class="collapse-icon">▼</span>
                <span class="section-title-text">Servicios prestados</span>
                <div style="margin-left:auto; display:flex; gap:6px;">
                  <button type="button" id="btnNuevoServicio" class="btn btn-primary btn-small">Agregar servicio</button>
                </div>
              </div>
              <div class="section-body">
                <table class="table-servicios" style="width:100%; border-collapse:collapse;">
                  <thead>
                    <tr>
                      <th style="text-align:left;">Acciones</th>
                      <th style="text-align:left;">Servicio</th>
                      <th style="text-align:left;">Descripción</th>
                    </tr>
                  </thead>
                  <tbody id="tbodyServicios"></tbody>
                </table>
              </div>
            </div>

            <div class="collapsible-section">
              <div class="section-header-collapse collapsed">
                <span class="collapse-icon">▼</span>
                <span class="section-title-text">Sucursales</span>
                <div style="margin-left:auto; display:flex; gap:6px;">
                  <button type="button" id="btnNuevaSucursal" class="btn btn-primary btn-small">Agregar sucursal</button>
                </div>
              </div>
              <div class="section-body">
                <table class="table-sucursales" style="width:100%; border-collapse:collapse;">
                  <thead>
                    <tr>
                      <th style="text-align:left;">Acciones</th>
                      <th style="text-align:left;">Tipo</th>
                      <th style="text-align:left;">Nombre</th>
                      <th style="text-align:left;">País</th>
                      <th style="text-align:left;">Estado</th>
                      <th style="text-align:left;">Municipio</th>
                    </tr>
                  </thead>
                  <tbody id="tbodySucursales"></tbody>
                </table>
              </div>
            </div>

            <div class="collapsible-section">
              <div class="section-header-collapse collapsed">
                <span class="collapse-icon">▼</span>
                <span class="section-title-text">Agenda de contactos</span>
                <div style="margin-left:auto; display:flex; gap:6px;">
                  <button type="button" id="btnNuevoContacto" class="btn btn-primary btn-small">Agregar contacto</button>
                </div>
              </div>
              <div class="section-body">
                <table class="table-contactos" style="width:100%; border-collapse:collapse;">
                  <thead>
                    <tr>
                      <th style="text-align:left;">Acciones</th>
                      <th style="text-align:left;">Área</th>
                      <th style="text-align:left;">Nombre</th>
                      <th style="text-align:left;">Teléfono</th>
                      <th style="text-align:left;">Correo</th>
                    </tr>
                  </thead>
                  <tbody id="tbodyContactos"></tbody>
                </table>
              </div>
            </div>
          </div>

          <!-- TAB: EXPEDIENTE (placeholder simple) -->
          <div id="tab-expediente" class="tab-content">
            <div class="collapsible-section">
              <div class="section-header-collapse">
                <span class="collapse-icon">▼</span>
                <span class="section-title-text">Información de Expediente</span>
              </div>
              <div class="section-body">
                <table style="width:100%; border-collapse:collapse;">
                  <tr>
                    <td style="width:15%;"><strong>Tipo</strong></td>
                    <td style="width:35%;"><input type="text" id="expTipo" class="form-control"></td>
                    <td style="width:15%;"><strong>Estado</strong></td>
                    <td style="width:35%;"><input type="text" id="expEstado" class="form-control"></td>
                  </tr>
                  <tr>
                    <td><strong>Notas</strong></td>
                    <td colspan="3"><input type="text" id="expNotas" class="form-control"></td>
                  </tr>
                </table>
              </div>
            </div>
          </div>

          <!-- TAB: VENTAS Y SALDOS (placeholder por ahora) -->
          <div id="tab-ventas" class="tab-content">
            <div class="collapsible-section">
              <div class="section-header-collapse">
                <span class="collapse-icon">▼</span>
                <span class="section-title-text">Condiciones comerciales</span>
              </div>
              <div class="section-body">
                <!-- Vacío - JavaScript lo llenará con "En Desarrollo" -->
              </div>
            </div>
            <div class="collapsible-section">
              <div class="section-header-collapse collapsed">
                <span class="collapse-icon">▼</span>
                <span class="section-title-text">Saldos y Cuentas</span>
              </div>
              <div class="section-body">
                <!-- Vacío - JavaScript lo llenará con "En Desarrollo" -->
              </div>
            </div>
          </div>

          
        </form>
      </div>

      <div class="modal-footer">
        <button id="btnCancelarProveedor" class="btn btn-outline">Cancelar</button>
        <button id="btnGuardarProveedor" class="btn btn-primary">Guardar</button>
      </div>
    </div>
  </div>

  <!-- Modal secundario: Agregar servicio al proveedor -->
  <div id="modalServicio" class="modal-overlay" style="display:none;">
    <div class="modal-container modal-compact modal-small">
      <div class="modal-header">
        <div class="modal-title">
          <h2>Agregar servicio</h2>
        </div>
        <div class="modal-header-buttons">
          <button id="btnCerrarModalServicio" class="btn-header-icon" title="Cerrar">×</button>
        </div>
      </div>
      <div class="modal-content-small">
        <form id="formServicio" class="form-container" onsubmit="return false;">
          <div class="collapsible-section">
            <div class="section-body">
              <table style="width:100%; border-collapse:collapse;">
                <tr>
                  <td style="width:25%;"><strong>Servicio</strong></td>
                  <td style="width:75%;"><input type="text" id="srvNombre" class="form-control" required></td>
                </tr>
                <tr>
                  <td><strong>Descripción</strong></td>
                  <td><input type="text" id="srvDescripcion" class="form-control"></td>
                </tr>
              </table>
            </div>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button id="btnGuardarServicio" class="btn btn-primary">Guardar</button>
        <button id="btnCancelarServicio" class="btn btn-outline">Cancelar</button>
      </div>
    </div>
  </div>

  <!-- Modal secundario: Agregar sucursal al proveedor -->
  <div id="modalSucursal" class="modal-overlay" style="display:none;">
    <div class="modal-container modal-compact modal-small">
      <div class="modal-header">
        <div class="modal-title">
          <h2>Agregar sucursal</h2>
        </div>
        <div class="modal-header-buttons">
          <button id="btnCerrarModalSucursal" class="btn-header-icon" title="Cerrar">×</button>
        </div>
      </div>
      <div class="modal-content-small">
        <form id="formSucursal" class="form-container" onsubmit="return false;">
          <div class="collapsible-section">
            <div class="section-body">
              <table style="width:100%; border-collapse:collapse;">
                <tr>
                  <td style="width:25%;"><strong>Tipo</strong></td>
                  <td style="width:75%;"><input type="text" id="sucTipo" class="form-control" value="Sucursal"></td>
                </tr>
                <tr>
                  <td><strong>Nombre</strong></td>
                  <td><input type="text" id="sucNombre" class="form-control" required></td>
                </tr>
                <tr>
                  <td><strong>País</strong></td>
                  <td><input type="text" id="sucPais" class="form-control"></td>
                </tr>
                <tr>
                  <td><strong>Estado</strong></td>
                  <td><input type="text" id="sucEstado" class="form-control"></td>
                </tr>
                <tr>
                  <td><strong>Municipio</strong></td>
                  <td><input type="text" id="sucMunicipio" class="form-control"></td>
                </tr>
              </table>
            </div>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button id="btnGuardarSucursal" class="btn btn-primary">Guardar</button>
        <button id="btnCancelarSucursal" class="btn btn-outline">Cancelar</button>
      </div>
    </div>
  </div>

  <!-- Modal secundario: Agregar contacto al proveedor -->
  <div id="modalContacto" class="modal-overlay" style="display:none;">
    <div class="modal-container modal-compact modal-small">
      <div class="modal-header">
        <div class="modal-title">
          <h2>Agregar contacto</h2>
        </div>
        <div class="modal-header-buttons">
          <button id="btnCerrarModalContacto" class="btn-header-icon" title="Cerrar">×</button>
        </div>
      </div>
      <div class="modal-content-small">
        <form id="formContacto" class="form-container" onsubmit="return false;">
          <div class="collapsible-section">
            <div class="section-body">
              <table style="width:100%; border-collapse:collapse;">
                <tr>
                  <td style="width:25%;"><strong>Área</strong></td>
                  <td style="width:75%;"><input type="text" id="ctoArea" class="form-control"></td>
                </tr>
                <tr>
                  <td><strong>Nombre</strong></td>
                  <td><input type="text" id="ctoNombre" class="form-control" required></td>
                </tr>
                <tr>
                  <td><strong>Teléfono</strong></td>
                  <td><input type="text" id="ctoTelefono" class="form-control"></td>
                </tr>
                <tr>
                  <td><strong>Correo</strong></td>
                  <td><input type="email" id="ctoCorreo" class="form-control"></td>
                </tr>
              </table>
            </div>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button id="btnGuardarContacto" class="btn btn-primary">Guardar</button>
        <button id="btnCancelarContacto" class="btn btn-outline">Cancelar</button>
      </div>
    </div>
  </div>

  <script src="/desarrollo.js"></script>
  <script src="/modules/compras/proveedores/proveedores.js"></script>
</body>
</html>
